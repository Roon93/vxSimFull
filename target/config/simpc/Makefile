#  Makefile - makefile skeleton for NTSIM
#
# Copyright 1984-2001 Wind River Systems, Inc.
#
# modification history
# --------------------
# 01i,18apr02,jmp  added ntEnd.c and winSio.c to DOC_FILES (SPR #75746).
# 01h,20nov01,jmp  redefined BINXSYM to do nothing, the symbol table is now
#                  generated by a simple copy by simpcToExe.tcl.
# 01g,15nov01,jmp  added bsp specific driver rule.
# 01f,14nov01,dat  RELEASE update
# 01e,25sep01,dat  Update for T2.2
# 01d,09jul98,ms   added LDOUT_CONV to create a .exe file after the build.
# 01c,29apr98,cym  added default rule and changed target name.
#		   changed to Makefile instead of Makefile.gnu
# 01b,13mar98,jmb  fix build of vxWorks.st
# 01a,13mar98,jmb  written.
#
# DESCRIPTION
# This file contains rules for building NTSIM under Cygwin32
#
#*/

CPU		= SIMNT
TOOL		= gnu

TGT_DIR = $(WIND_BASE)/target

include $(TGT_DIR)/h/make/defs.bsp
#include $(TGT_DIR)/h/make/make.$(CPU)$(TOOL)
#include $(TGT_DIR)/h/make/defs.$(WIND_HOST_TYPE)

## Only redefine make definitions below this point, or your definitions will
## be overwritten by the makefile stubs above.


TARGET_DIR = simpc
VENDOR     =
BOARD      = vxWorks Simulator for Windows
DOC_FILES  = sysLib winSio ntEnd

VXSIZEPROG = echo
LDOUT_CONV = wtxtcl $(WIND_BASE)/host/$(WIND_HOST_TYPE)/bin/simpcToExe.tcl
BINXSYM	   = echo

#  crt1.o goes at the beginning of the executable file in order to
#  get mainCRTStartup at 0x401000
#
LD_LOW_FLAGS = $(WIND_BASE)/host/$(WIND_HOST_TYPE)/i386-pc-mingw32/lib/crt1.o

LIB_EXTRA = $(TGT_DIR)/config/simpc/simpcDrv.a	# Bsp specific drvs.

$(TGT_DIR)/config/simpc/simpcDrv.a : $(TGT_DIR)/config/simpc/winSio.c $(TGT_DIR)/config/simpc/winSio.h $(TGT_DIR)/config/simpc/ntEnd.c
	$(RM) $(TGT_DIR)/config/simpc/simpcDrv.a $(TGT_DIR)/config/simpc/ntEnd.o $(TGT_DIR)/config/simpc/winSio.o
	$(MAKE) "CC_OPTIM=$(CC_OPTIM_DRIVER)" $(TGT_DIR)/config/simpc/ntEnd.o
	$(MAKE) "CC_OPTIM=$(CC_OPTIM_DRIVER)" $(TGT_DIR)/config/simpc/winSio.o
	$(AR) cru $(TGT_DIR)/config/simpc/simpcDrv.a $(TGT_DIR)/config/simpc/ntEnd.o $(TGT_DIR)/config/simpc/winSio.o
	$(RANLIB) $(TGT_DIR)/config/simpc/simpcDrv.a

#
#  vxWorks.st needs some work -- no makeSymTbl.sh for this target
#  No ROM images, just a single project, single build spec
#
RELEASE = vxWorks bsp2prj


## Only redefine make definitions above this point, or the expansion of 
## makefile target dependencies may be incorrect.

include $(TGT_DIR)/h/make/rules.bsp
#include $(TGT_DIR)/h/make/rules.$(WIND_HOST_TYPE)

